---
title: "Untitled"
author: "Pedro Cavalcante"
date: "July 28, 2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# O Teorema de Perron-Frobenius

* *Teorema (Perron-Frobenius):* Seja $A$ um operador linear cuja matriz associada é positiva. Então $A$ tem um único autovetor positivo, cujo autovalor tem multiplicidade unitária e é maior em módulo que qualquer outro autovalor de $A$. 

* *Prova:* 



* *Proposição:* Seja $A$ uma matriz estocástica positiva $n \times n$ e $\phi_n$ o conjunto de contrações do simplex $\Delta_{n}$ em si mesmo. $A_{n x n} \in \phi_{n-1}$.

*Prova:* Ver @shih2013positive.

# Verificando esse resultado computacionalmente

A função ``eigen()`` faz a decomposição espectral de matrizes com métodos numéricos então a usaremos para aproximar os autovalores e vetores de várias matrizes simuladas. 


```{R eval = FALSE}
set.seed(1234)
n = 100000 
m = 4

autovalores1 = vector()
autovalores2 = vector()

tic("matrizes")
for(i in 1:n) {
  
  tirada = runif(n = m) %>% round(digits = 2)
  matriz = tirada %>% matrix(ncol = 2)
  auto = eigen(matriz)
  
  autovalores1[i] = auto$values[1]
  autovalores2[i] = auto$values[2]
  
  
}
toc()
dados = tibble(A = autovalores1,
               B = autovalores2)

medias = dados %>%
  summarise(meanA = mean(A),
            meanB = mean(B))

medias 
```


E para matrizes não-estocásticas

```{R eval = FALSE}
set.seed(1234)
n = 100000
m = 4

autovalores12 = vector()
autovalores22 = vector()




for(i in 1:n) {
  
  tirada2 = runif(n = m, min = -1, max = 1) %>% round(digits = 3)
  matriz2 = tirada %>% matrix(ncol = 2)
  auto2 = eigen(matriz2)
  
  autovalores12[i] = auto2$values[1]
  autovalores22[i] = auto2$values[2]
  
  
}

dados2 = tibble(A2 = autovalores12,
               B2 = autovalores22)

medias2 = dados2 %>%
  summarise(meanA2 = mean(A2),
            meanB2 = mean(B2))

medias2 
```