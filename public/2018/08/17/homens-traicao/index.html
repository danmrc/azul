<!DOCTYPE html>
<html lang='en'>

<head>
  <meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='description' content='Você acha que homens traem mais? Eu sei que existe toda uma literatura empírica sobre o tema (ou seriam comédias românticas? nunca lembro), mas acho interessante trazer alguns dados. A fonte dos que vou usar hoje é Fair (JPE 1978), compilado no incrível manual de econometria introdutória do professor Jeffrey Wooldridge (MSU).
Vamos rodar um modelo probabilístico para ver se podemos dar nossos dois centavos nessa questão.
ProbitsProbits são, essencialmente, modelos lineares generalizados (GLM) em que a variável de resposta assume valores binários.'>
<meta name='theme-color' content='#ffcd00'>

<meta property='og:title' content='Homens têm mais casos extraconjugais? • Pedro Cavalcante'>
<meta property='og:description' content='Você acha que homens traem mais? Eu sei que existe toda uma literatura empírica sobre o tema (ou seriam comédias românticas? nunca lembro), mas acho interessante trazer alguns dados. A fonte dos que vou usar hoje é Fair (JPE 1978), compilado no incrível manual de econometria introdutória do professor Jeffrey Wooldridge (MSU).
Vamos rodar um modelo probabilístico para ver se podemos dar nossos dois centavos nessa questão.
ProbitsProbits são, essencialmente, modelos lineares generalizados (GLM) em que a variável de resposta assume valores binários.'>
<meta property='og:url' content='/2018/08/17/homens-traicao/'>
<meta property='og:site_name' content='AZUL'>
<meta property='og:type' content='article'><meta property='og:image' content='https://www.gravatar.com/avatar/6257e4bc50db642ff52a5ab484db3859?s=256'><meta property='article:section' content='post'><meta property='article:tag' content='R'><meta property='article:tag' content='Probit'><meta property='article:published_time' content='2018-08-17T00:00:00Z'/><meta property='article:modified_time' content='2018-08-17T00:00:00Z'/><meta name='twitter:card' content='summary'><meta name='twitter:creator' content='@https://twitter.com/PedrooCava'>

<meta name="generator" content="Hugo 0.45" />

  <title>Homens têm mais casos extraconjugais? • Pedro Cavalcante</title>
  <link rel='canonical' href='/2018/08/17/homens-traicao/'>
  
  
  <link rel='icon' href='/favicon.ico'>
<link rel='stylesheet' href='/assets/css/main.4267b3fa.css'><link rel='stylesheet' href='/css/custom.css'><style>
:root{--color-accent:#ffcd00;}
</style>

<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-123754589-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

  

</head>


<body class='page type-post has-sidebar'>

  <div class='site'>

    <div id='sidebar' class='sidebar'>
  <a class='screen-reader-text' href='#main-menu'>Skip to Main Menu</a>

  <div class='container'><section class='widget widget-about sep-after'>
  <header>
    
    <div class='logo'>
      <a href='/'>
        <img src='/images/logo.png'>
      </a>
    </div>
    
    <h2 class='title site-title '>
    AZUL
    </h2>
    <div class='desc'>
    Economia, Estatística, Programação
    </div>
  </header>

</section>
<section class='widget widget-search sep-after'>
  <header>
    <h4 class='title widget-title'>Search</h4>
  </header>

  <form action='/search' id='search-form' class='search-form'>
    <label>
      <span class='screen-reader-text'>Search</span>
      <input id='search-term' class='search-term' type='search' name='q' placeholder='Search&hellip;'>
    </label></form>

</section>
<section class='widget widget-taxonomy_cloud sep-after'>
  <header>
    <h4 class='title widget-title'>Tags</h4>
  </header>

  <div class='container list-container'>
  <ul class='list taxonomy-cloud'><li>
        <a href='/tags/apresenta%C3%A7%C3%A3o/' style='font-size:1em'>Apresentação</a>
      </li><li>
        <a href='/tags/clustering/' style='font-size:1.125em'>Clustering</a>
      </li><li>
        <a href='/tags/econometria/' style='font-size:1em'>Econometria</a>
      </li><li>
        <a href='/tags/economia/' style='font-size:1.125em'>Economia</a>
      </li><li>
        <a href='/tags/economia-da-educa%C3%A7%C3%A3o/' style='font-size:1em'>Economia Da Educação</a>
      </li><li>
        <a href='/tags/interpola%C3%A7%C3%A3o/' style='font-size:1em'>Interpolação</a>
      </li><li>
        <a href='/tags/julia/' style='font-size:1.375em'>Julia</a>
      </li><li>
        <a href='/tags/lasso/' style='font-size:1em'>Lasso</a>
      </li><li>
        <a href='/tags/machine-learning/' style='font-size:1em'>Machine Learning</a>
      </li><li>
        <a href='/tags/macroeconomia/' style='font-size:1em'>Macroeconomia</a>
      </li><li>
        <a href='/tags/microeconomia/' style='font-size:1em'>Microeconomia</a>
      </li><li>
        <a href='/tags/monte-carlo/' style='font-size:1.125em'>Monte Carlo</a>
      </li><li>
        <a href='/tags/probit/' style='font-size:1em'>Probit</a>
      </li><li>
        <a href='/tags/profiling/' style='font-size:1em'>Profiling</a>
      </li><li>
        <a href='/tags/programa%C3%A7%C3%A3o-din%C3%A2mica/' style='font-size:1.125em'>Programação Dinâmica</a>
      </li><li>
        <a href='/tags/r/' style='font-size:2em'>R</a>
      </li><li>
        <a href='/tags/sazonalidade/' style='font-size:1em'>Sazonalidade</a>
      </li><li>
        <a href='/tags/simula%C3%A7%C3%A3o/' style='font-size:1.125em'>Simulação</a>
      </li><li>
        <a href='/tags/solow/' style='font-size:1em'>Solow</a>
      </li><li>
        <a href='/tags/tutoriais/' style='font-size:1em'>Tutoriais</a>
      </li><li>
        <a href='/tags/vari%C3%A1veis-instrumentais/' style='font-size:1em'>Variáveis Instrumentais</a>
      </li></ul>
</div>


</section>
</div>

  <div class='sidebar-overlay'></div>
</div>

    <div class='main'>

      <nav id='main-menu' class='menu main-menu' aria-label='Main Menu'>
  <div class='container'>
    <a class='screen-reader-text' href='#content'>Skip to Content</a>

<button id='sidebar-toggler' class='sidebar-toggler' aria-controls='sidebar'>
  <span class='screen-reader-text'>Toggle Sidebar</span>
  <span class='open'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <line x1="3" y1="12" x2="21" y2="12" />
  <line x1="3" y1="6" x2="21" y2="6" />
  <line x1="3" y1="18" x2="21" y2="18" />
  
</svg>
</span>
  <span class='close'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <line x1="18" y1="6" x2="6" y2="18" />
  <line x1="6" y1="6" x2="18" y2="18" />
  
</svg>
</span>
</button>
    <ul><li class='item'>
        <a href=''>GitHub</a>
      </li><li class='item'>
        <a href='/about/'>Sobre</a>
      </li><li class='item'>
        <a href='/post'>Tudo</a>
      </li><li class='item'>
        <a href=''>Twitter</a>
      </li></ul>
  </div>
</nav>

      <header id='header' class='header site-header'>
        <div class='container sep-after'>
          <div class='header-info'><p class='site-title title'>AZUL</p><p class='desc site-desc'>Economia, Estatística, Programação</p>
          </div>
        </div>
      </header>

      <main id='content'>


<article lang='en' class='entry'>
  <header class='header entry-header'>
  <div class='container sep-after'>
    <div class='header-info'>
      <h1 class='title'>Homens têm mais casos extraconjugais?</h1>
      

    </div>
    
<div class='entry-meta'>
  <span class='posted-on'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/>
  <line x1="16" y1="2" x2="16" y2="6"/>
  <line x1="8" y1="2" x2="8" y2="6"/>
  <line x1="3" y1="10" x2="21" y2="10"/>
  
</svg>
<span class='screen-reader-text'>Posted on </span>
  <time class='entry-date' datetime='2018-08-17T00:00:00Z'>2018, Aug 17</time>
</span>

  <span class='byline'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <path d="M21,21V20c0-2.76-4-5-9-5s-9,2.24-9,5v1"/>
  <path d="M16,6.37A4,4,0,1,1,12.63,3,4,4,0,0,1,16,6.37Z"/>
  
</svg>
<span class='screen-reader-text'> by </span><a href='/authors/pedrocava'>Pedro Cavalcante</a></span>
  
<span class='reading-time'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <circle cx="12" cy="12" r="10"/>
  <polyline points="12 6 12 12 15 15"/>
  
</svg>
5 mins read
</span>


</div>


  </div>
</header>

  
  

  <div class='container entry-content'>
  <p>Você acha que homens traem mais? Eu sei que existe toda uma literatura empírica sobre o tema (ou seriam comédias românticas? nunca lembro), mas acho interessante trazer alguns dados. A fonte dos que vou usar hoje é <a href="http://people.stern.nyu.edu/wgreene/Lugano2013/Fair-ExtramaritalAffairs.pdf">Fair (JPE 1978)</a>, compilado no incrível manual de econometria introdutória do professor Jeffrey Wooldridge (MSU).</p>
<p>Vamos rodar um modelo probabilístico para ver se podemos dar nossos dois centavos nessa questão.</p>
<div id="probits" class="section level2">
<h2>Probits</h2>
<p>Probits são, essencialmente, modelos lineares generalizados (GLM) em que a variável de resposta assume valores binários. Os parâmetros estimados no dizem em que medida uma variação marginal em uma variável explicativa altera o <span class="math inline">\(z\)</span>-score da variável dependente, não a sua probabilidade condicional de assumir <span class="math inline">\(1\)</span>.</p>
<p>Seja <span class="math inline">\(\mathbb{P}\)</span> o operador para probabilidade, <span class="math inline">\(\Phi\)</span> a função de distribuição cumultiva de uma normal padrão, <span class="math inline">\(X\)</span> um vetor de variáveis aleatórias e <span class="math inline">\(\beta\)</span> o vetor de parâmetros a ser estimado. Um modelo probit assume a seguinte forma:</p>
<p><span class="math display">\[\mathbb{P}(Y=1 | X) = \Phi (X^T \beta)\]</span></p>
<p>É possível também exprimir o modelo como <span class="math inline">\(Y^{*} = X^T \beta + \epsilon\)</span> e mostrar que as duas formas são equivalentes é um exercício interessante.</p>
<p>Não irei entrar nos pormenores de como se pode estimar os parâmetros desse modelo. A função <code>glm</code> disponível no R usa estimação por Máxima Verossimilhança, até onde sei.</p>
</div>
<div id="a-amostra" class="section level2">
<h2>A amostra</h2>
<p>Vamos explorar um pouco os dados com a ajuda do <code>ggplot2</code> antes de sair por aí estimando parâmetros:</p>
<pre class="r"><code>library(wooldridge)

data(&quot;affairs&quot;)

head(affairs) ## Confirmando que funcionou</code></pre>
<pre><code>##   id male age yrsmarr kids relig educ occup ratemarr naffairs affair
## 1  4    1  37    10.0    0     3   18     7        4        0      0
## 2  5    0  27     4.0    0     4   14     6        4        0      0
## 3  6    1  27     1.5    0     3   18     4        4        3      1
## 4 11    0  32    15.0    1     1   12     1        4        0      0
## 5 12    0  27     4.0    1     3   17     1        5        3      1
## 6 16    1  57    15.0    1     5   18     6        5        0      0
##   vryhap hapavg avgmarr unhap vryrel smerel slghtrel notrel
## 1      0      1       0     0      0      0        1      0
## 2      0      1       0     0      0      1        0      0
## 3      0      1       0     0      0      0        1      0
## 4      0      1       0     0      0      0        0      0
## 5      1      0       0     0      0      0        1      0
## 6      1      0       0     0      1      0        0      0</code></pre>
<pre class="r"><code>library(ggplot2)
library(dplyr)</code></pre>
<pre><code>## 
## Attaching package: &#39;dplyr&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:stats&#39;:
## 
##     filter, lag</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     intersect, setdiff, setequal, union</code></pre>
<pre class="r"><code>library(scales)

affairs %&gt;%
  ggplot(aes(x=yrsmarr))+
  geom_histogram(binwidth = 1, fill = &quot;white&quot;, color=&quot;blue&quot;)+
  xlab(&quot;Anos de Casamento&quot;)+
  ylab(&quot;Frequência&quot;)</code></pre>
<p><img src="/post/homens-traicao_files/figure-html/graficos-1.png" width="7000" /></p>
<pre class="r"><code>affairs %&gt;%
  ggplot(aes(x=ratemarr))+
  geom_histogram(binwidth = 1, fill = &quot;white&quot;, color=&quot;blue&quot;)+
  xlab(&quot;Avaliação do Casamento (1 = infeliz, 5 = muito feliz)&quot;)+
  ylab(&quot;Frequência&quot;)</code></pre>
<p><img src="/post/homens-traicao_files/figure-html/graficos-2.png" width="7000" /></p>
<pre class="r"><code>affairs %&gt;%
  ggplot(aes(x=affair))+
  geom_histogram(aes(y=..density..), bins = 2,
                  fill = &quot;white&quot;, color=&quot;blue&quot;)+
  scale_y_continuous(labels = percent)+
  xlab(&quot;Teve um caso no ano anterior (1 = sim, 0 = não)&quot;)+
  ylab(&quot;&quot;)</code></pre>
<p><img src="/post/homens-traicao_files/figure-html/graficos-3.png" width="7000" /></p>
</div>
<div id="estimando-um-modelo-probit" class="section level2">
<h2>Estimando um modelo probit</h2>
<p>O R “vanilla” já conta com ferramentas para estimar modelos desse tipo:</p>
<pre class="r"><code>affairs$rel &lt;- ifelse(affairs$relig &gt; 2, 1, 0) #dummy de religiosidade
affairs$feliz &lt;- ifelse(affairs$ratemarr &gt; 2, 1, 0) #dummy de casamento feliz

probit &lt;- glm(affair ~ male + kids + feliz + rel + educ + yrsmarr + age,
                family = binomial(link = &quot;probit&quot;),
                  data = affairs)
summary(probit)</code></pre>
<pre><code>## 
## Call:
## glm(formula = affair ~ male + kids + feliz + rel + educ + yrsmarr + 
##     age, family = binomial(link = &quot;probit&quot;), data = affairs)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -1.5816  -0.7550  -0.6043  -0.3185   2.3605  
## 
## Coefficients:
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)  0.01521    0.47890   0.032  0.97466    
## male         0.20968    0.12964   1.617  0.10579    
## kids         0.23355    0.16199   1.442  0.14937    
## feliz       -0.74577    0.15740  -4.738 2.16e-06 ***
## rel         -0.25022    0.12236  -2.045  0.04086 *  
## educ         0.01169    0.02620   0.446  0.65554    
## yrsmarr      0.05518    0.01857   2.971  0.00297 ** 
## age         -0.02583    0.01036  -2.494  0.01264 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 675.38  on 600  degrees of freedom
## Residual deviance: 625.27  on 593  degrees of freedom
## AIC: 641.27
## 
## Number of Fisher Scoring iterations: 4</code></pre>
<p>O problema desse modelo no atual estado é que os parâmetros representam mudanças no <span class="math inline">\(z\)</span>-score da variável explicada e não são facilmente interpretados. Seria mais interessante ter variações diretas na probabilidade condicional <span class="math inline">\(\mathbb{P}(Y=1 | X)\)</span>. Temos ferramentas para isso, no pacote <code>mfx</code>.</p>
<pre class="r"><code>library(mfx)

probitmfx(affair ~ male + kids + feliz + rel + educ + yrsmarr + age,
              data = affairs)</code></pre>
<pre><code>## Call:
## probitmfx(formula = affair ~ male + kids + feliz + rel + educ + 
##     yrsmarr + age, data = affairs)
## 
## Marginal Effects:
##              dF/dx  Std. Err.       z     P&gt;|z|    
## male     0.0645982  0.0399656  1.6163  0.106020    
## kids     0.0690378  0.0458475  1.5058  0.132115    
## feliz   -0.2637864  0.0600435 -4.3933 1.117e-05 ***
## rel     -0.0787878  0.0393153 -2.0040  0.045070 *  
## educ     0.0035905  0.0080486  0.4461  0.655527    
## yrsmarr  0.0169520  0.0056885  2.9800  0.002882 ** 
## age     -0.0079351  0.0031755 -2.4988  0.012461 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## dF/dx is for discrete change for the following variables:
## 
## [1] &quot;male&quot;  &quot;kids&quot;  &quot;feliz&quot; &quot;rel&quot;</code></pre>
<p>Aqui sim, os parâmetros podem ser lidos como variações na probabilidade condicional de <span class="math inline">\(Y=1\)</span>. Observe, leitor que a variável explicativa <code>male</code> não é estatisticamente significante. Talvez precisamos de uma amostra maior.</p>
</div>

</div>

  
<footer class='entry-footer'>
  <div class='container sep-before'><div class='categories'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <path d="M22,19a2,2,0,0,1-2,2H4a2,2,0,0,1-2-2V5A2,2,0,0,1,4,3H9l2,3h9a2,2,0,0,1,2,2Z"/>
  
</svg>
<span class='screen-reader-text'>Categories: </span></div>
<div class='tags'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <path d="M20.59,13.41l-7.17,7.17a2,2,0,0,1-2.83,0L2,12V2H12l8.59,8.59A2,2,0,0,1,20.59,13.41Z"/>
  <line x1="7" y1="7" x2="7" y2="7"/>
  
</svg>
<span class='screen-reader-text'>Tags: </span></div>

  </div>
</footer>


</article>

<nav class='entry-nav'>
  <div class='container'><div class='prev-entry sep-before'>
      <a href='/2018/08/11/prouni-clustering/'>
        <span aria-hidden='true'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <line x1="20" y1="12" x2="4" y2="12"/>
  <polyline points="10 18 4 12 10 6"/>
  
</svg>
 Previous</span>
        <span class='screen-reader-text'>Previous post: </span>Usando clustering para identificar cursos no Prouni</a>
    </div><div class='next-entry sep-before'>
      <a href='/2018/08/19/vi%C3%A9s-de-vari%C3%A1veis-instrumentais/'>
        <span class='screen-reader-text'>Next post: </span>Viés de variáveis instrumentais<span aria-hidden='true'>Next <svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <line x1="4" y1="12" x2="20" y2="12"/>
  <polyline points="14 6 20 12 14 18"/>
  
</svg>
</span>
      </a>
    </div></div>
</nav>




      </main>

      <footer id='footer' class='footer'>
        <div class='container sep-before'><div class='copyright'>
  <p></p>
</div>

        </div>
      </footer>

    </div>
  </div><script>window.__public_path__='\/assets\/js\/'</script>

<script src='/assets/js/main.59f76c44.js'></script><script src='/js/custom.js'></script><link rel='stylesheet' href='//unpkg.com/katex/dist/katex.min.css'>
<script src='//unpkg.com/katex/dist/katex.min.js'></script>
<script src='//unpkg.com/katex/dist/contrib/auto-render.min.js'></script>

<script type='text/javascript'>
  renderMathInElement(document.querySelector('.entry-content'),{});
</script>

</body>

</html>

